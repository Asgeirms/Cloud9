# Cloud9 web application

## Table of contents
  - [Getting started](#getting-started)
  - [Prerequisities](#prerequisities)
  - [Intalling](#intalling)
  - [Running](#running)
    - [Sign in as admin](#sign-in-as-admin)
    - [Load initial data](#load-initial-data)
      - [Google Sheet API](#google-sheet-api)
      - [Run script and load data](#run-script)
  - [Tests](#tests)
  - [Coding style and standards](#coding-style-and-standards)
  - [Licence](#licence)


## Getting started 
1. Clone this repository in your desired project folder. A solution is to use HTTPS as shown below, alternatively SSH is another option.
```
git clone https://github.com/Asgeirms/Cloud9.git
```

2. Enter the cloned repo and web project:
```
cd Cloud9/web
```
or for Windows replace the `/` with `\`.


## Prerequisities
It is strongly recommended to have virtual environments when running or working with any Python projects. Run this command if you have not created one already.
```
python -m venv .venv
```

By default the the virtual environtment is turned off. It can easily be activated by running the following command. It is also recommended to have this configured in the IDE settings to have this stored as a default Python interpreter. 
```
.venv/Scripts/activate.bat
```
Again for Windows remember to replace the `/` with `\`.

## Intalling 
When the venv is activated, dependencies specified in requirements.txt are required to install in order to run this project.
```
pip install -r requirements.txt
```

## Running
Further apply migrations
```
python manage.py migrate
```

If everything went smoothly, the project is ready to run! 
```
python manage.py runserver [portnumber]
```
`portnumber`: optionally to specify an alternatively portnummber. Default is 8000.

The server can be access in your browser at `localhost:8000`

### Sign in as admin
Admin, also known as a `superuser` in this scope allows arbitrary permissions, including curating the events. It is also possible to create a regular user in the registration form.
```
python manage.py createsuperuser
```
The Django admin panel can be accessed at [localhost:8000/admin](localhost:8000/admin)

### Load initial data

The database looks a bit empty for a newly initiated project. Luckily, we have provided a script that dumps some useful data into a json file that can used to easily propagate it to the database.

#### Google Sheet API
Before running, a prerequisite to run this script is having the `API key` for accessing the Google Spreadsheet which it is fetching the data from. The API key is provided upon request. 


#### Store API key as env variables [`optional`]
It is highly recommended to store the API key in environment settings to avoid it being exposed through a public repository. This can be easily done by creating a `.env` file in the root folder. Then store the API key by assigning it to a variable in `.env` such as:
```
SHEET_KEY = SECRET_API_KEY
```
**Note: without quotes**


#### Run script and load data

1. Must have created a user or superuser in order to load the initial events as it will default attach all the events to this user.

2. Run the `Python` script to dump the data. Need to run `dump_categories.py` first before running `events.json` as events are dependent on categories. 
```
python happenings/fixtures/dump_categories.py
```
3. Load the file to database
```
python manage.py loaddata categories.json
```
Repeat step 2 and 3 again with `dump_events.py`


Running the script multiple times only result it to update to current state of the spreadsheet. Likewise with the autogenerated datetime for schedules. If you have some events that have passed, running the script and load the data will only result it to overwrite old datetime and thus have new upcoming events. 

## Tests
To run all tests in the project, run the following command
```
python manage.py tests
```

## Coding style and standards
TODO


## Licence
TODO

